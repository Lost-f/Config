# ==================== æ ¸å¿ƒé…ç½® ====================
# åŸºç¡€é…ç½®
mode: rule
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7895
ipv6: true
allow-lan: true
unified-delay: true
tcp-concurrent: true
log-level: warning
bind-address: '*'
find-process-mode: 'always'
global-client-fingerprint: chrome
keep-alive-interval: 15
keep-alive-idle: 600

# è®¤è¯é…ç½®
authentication:
  - mihomo:yyds999
skip-auth-prefixes:
  - 192.168.1.0/24
  - 192.168.31.0/24
  - 192.168.100.0/24
  - 127.0.0.1/8

# å®éªŒæ€§åŠŸèƒ½
experimental:
  quic-go-disable-gso: true  
     
# ç®¡ç†é¢æ¿é…ç½®
external-ui-url: https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip
external-ui-name: zashboard
external-ui: ui
external-controller: 127.0.0.1:9090
secret: yyds999

# é…ç½®å­˜å‚¨
profile:
  store-selected: true
  store-fake-ip: true

# æµé‡å—…æ¢
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - "+.push.apple.com"

# TUNæ¨¡å¼é…ç½®
tun:
  enable: false
  stack: mixed
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true
    
# DNSé…ç½®
dns:
  enable: true
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - 180.184.1.1
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  fake-ip-filter:
    - "*"
    - +.lan
    - +.local
    - time.*.com
    - ntp.*.com
    - +.market.xiaomi.com
    - +.miwifi.com
    - +.docker.io
    - +.push.apple.com

# ==================== ä»£ç†ç­–ç•¥ç»„ ====================
# ä»£ç†ç­–ç•¥ç»„é…ç½®ï¼ˆproxy-groupsï¼‰
proxy-groups:
  - name: Proxy                  # ä¸»ç­–ç•¥ç»„ï¼Œç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹æ—¶é¦–é€‰
    type: select                 # é€‰æ‹©ç±»å‹ï¼Œç”¨æˆ·å¯æ‰‹åŠ¨é€‰æ‹©å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹æˆ–ç­–ç•¥ç»„
    proxies:
      - Auto                     # è°ƒç”¨Autoç­–ç•¥ç»„ï¼ˆæ™ºèƒ½æµ‹é€Ÿé€‰æœ€å¿«ï¼‰
      - HK                       # é¦™æ¸¯èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - TW                       # å°æ¹¾èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - SG                       # æ–°åŠ å¡èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - JP                       # æ—¥æœ¬èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - US                       # ç¾å›½èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - KR                       # éŸ©å›½èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - EU                       # æ¬§æ´²èŠ‚ç‚¹é›†åˆï¼ˆurl-testç­–ç•¥ç»„ï¼‰
      - Select                   # å¦ä¸€ä¸ªæ‰‹åŠ¨é€‰æ‹©ç­–ç•¥ç»„
      - DIRECT                   # ç›´è¿ï¼Œä¸èµ°ä»£ç†
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Apple_News.png

  - name: Select                 # Selectç­–ç•¥ç»„ï¼ŒåŒ…å«æ‰€æœ‰èŠ‚ç‚¹åŠç­–ç•¥ï¼Œæ–¹ä¾¿æ‰‹åŠ¨ç²¾ç»†è°ƒèŠ‚
    include-all: true            # åŒ…å«æ‰€æœ‰ä»£ç†èŠ‚ç‚¹
    type: select                 # æ‰‹åŠ¨é€‰æ‹©èŠ‚ç‚¹
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Airport.png

  - name: Auto                  # æ™ºèƒ½æµ‹é€ŸAutoæœ€å¿«èŠ‚ç‚¹ï¼ŒèŠ‚çœç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©æ—¶é—´
    type: url-test              # é€šè¿‡è®¿é—®æŒ‡å®šURLæµ‹é€Ÿå»¶è¿Ÿæ¥åˆ¤æ–­èŠ‚ç‚¹å¿«æ…¢
    include-all: true           # æµ‹è¯•æ‰€æœ‰ä»£ç†èŠ‚ç‚¹
    interval: 600               # æµ‹é€Ÿé—´éš”ï¼Œå•ä½ç§’ï¼Œ86400ç§’=24å°æ—¶
    tolerance: 50               # å»¶è¿Ÿå®¹å¿åº¦ï¼Œå•ä½æ¯«ç§’ï¼Œ50msä»¥å†…è§†ä¸ºå¯æ¥å—
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Auto.png
    
  # Finalï¼Œæœªè¢«è§„åˆ™æ•è·çš„æµé‡èµ°è¿™é‡Œï¼Œä¿è¯ä¸ä¸¢åŒ…
  - name: Final
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Final.png

  # ä»¥ä¸‹æ˜¯åŸºäºèŠ‚ç‚¹åç§°åŒ¹é…è‡ªåŠ¨æµ‹è¯•å»¶è¿Ÿï¼Œç­›é€‰å‡ºå„åŒºåŸŸâ€œæ™ºé€‰â€èŠ‚ç‚¹
  - name: HK
    include-all: true
    filter: (?i)æ¸¯|HK|hk|Hong Kong|HongKong|hongkong   # èŠ‚ç‚¹ååŒ¹é…è§„åˆ™ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼‰
    type: url-test                                     # é€šè¿‡è®¿é—®ç‰¹å®šURLæµ‹é€Ÿå»¶è¿Ÿ
    interval: 300                                      # æ¯5åˆ†é’Ÿæµ‹é€Ÿä¸€æ¬¡
    tolerance: 50                                      # å»¶è¿Ÿå®¹å¿åº¦50ms
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Hong_Kong.png

  - name: TW
    include-all: true
    filter: (?i)å°|æ–°åŒ—|å½°åŒ–|TW|Taiwan
    type: url-test
    interval: 300
    tolerance: 50
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/TW.png

  - name: JP
    include-all: true
    filter: (?i)æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|JP|Japan
    type: url-test
    interval: 300
    tolerance: 50
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Japan.png

  - name: US
    include-all: true
    filter: (?i)ç¾|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|US|United States
    type: url-test
    interval: 300
    tolerance: 50
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/United_States.png

  - name: SG
    include-all: true
    filter: (?i)æ–°åŠ å¡|å¡|ç‹®åŸ|SG|Singapore
    type: url-test
    interval: 300
    tolerance: 50
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Singapore.png

  - name: KR
    include-all: true
    filter: (?i)KR|Korea|KOR|é¦–å°”|éŸ©|éŸ“
    type: url-test
    interval: 300
    tolerance: 50
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Korea.png
  
    - name: EU
    include-all: true
    filter:  ^(?=.*(?i)(å¥¥|æ¯”|ä¿|å…‹ç½—åœ°äºš|å¡|æ·|ä¸¹|çˆ±æ²™|èŠ¬|æ³•|å¾·|å¸Œ|åŒˆ|çˆ±å°”|æ„|æ‹‰|ç«‹|å¢|é©¬å…¶å®ƒ|è·|æ³¢|è‘¡|ç½—|æ–¯æ´›ä¼|æ–¯æ´›æ–‡|è¥¿|ç‘|è‹±|ğŸ‡§ğŸ‡ª|ğŸ‡¨ğŸ‡¿|ğŸ‡©ğŸ‡°|ğŸ‡«ğŸ‡®|ğŸ‡«ğŸ‡·|ğŸ‡©ğŸ‡ª|ğŸ‡®ğŸ‡ª|ğŸ‡®ğŸ‡¹|ğŸ‡±ğŸ‡¹|ğŸ‡±ğŸ‡º|ğŸ‡³ğŸ‡±|ğŸ‡µğŸ‡±|ğŸ‡¸ğŸ‡ª|ğŸ‡¬ğŸ‡§|CDG|FRA|AMS|MAD|BCN|FCO|MUC|BRU)).*$
    type: url-test
    interval: 300
    tolerance: 50
  
  # ä»¥ä¸‹æ˜¯é’ˆå¯¹ç‰¹å®šåº”ç”¨æˆ–ç”¨é€”çš„ç­–ç•¥ç»„ï¼Œæ–¹ä¾¿è§„åˆ™è°ƒç”¨åŠåˆ†æµ
  - name: LocationDKS
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Area.png
    
  - name: Telegram
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Telegram.png

  - name: AI
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Siri.png

  - name: YouTube
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/YouTube.png

  - name: TikTok
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/TikTok.png

  # Googleç›¸å…³æœåŠ¡ç­–ç•¥ç»„
  - name: Google
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Google_Search.png

  # Appleç›¸å…³æœåŠ¡ç­–ç•¥ç»„
  - name: Apple
    type: select
    proxies:
      - Proxy
      - Auto
      - HK
      - TW
      - SG
      - JP
      - US
      - KR
      - EU
      - Select
      - DIRECT
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Apple.png

# ç­–ç•¥ç»„å‚æ•°é”šç‚¹
# é”šç‚¹ - æ—¶å»¶ä¼˜é€‰å‚æ•° [æ¯ 6 ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œå®¹å·® 20msï¼Œæ—¶å»¶è¶…è¿‡ 2 ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥ 3 æ¬¡åˆ™è‡ªåŠ¨è§¦å‘å¥åº·æ£€æŸ¥]
UrlTest: &UrlTest {type: url-test, interval: 6, tolerance: 20, lazy: true, url: 'http://www.google.com/blank.html', disable-udp: false, timeout: 2000, max-failed-times: 3, hidden: true, include-all-providers: true}
# é”šç‚¹ - æ•…éšœè½¬ç§»å‚æ•° [æ¯ 6 ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œæ—¶å»¶è¶…è¿‡ 2 ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥ 3 æ¬¡åˆ™è‡ªåŠ¨è§¦å‘å¥åº·æ£€æŸ¥]
FallBack: &FallBack {type: fallback, interval: 6, lazy: true, url: 'http://www.google.com/blank.html', disable-udp: false, timeout: 2000, max-failed-times: 3, hidden: true, include-all-providers: true}
# é”šç‚¹ - è´Ÿè½½å‡è¡¡å‚æ•° [æ¯ 6 ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œæ—¶å»¶è¶…è¿‡ 2 ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥ 3 æ¬¡åˆ™è‡ªåŠ¨è§¦å‘å¥åº·æ£€æŸ¥]
LoadBalance: &LoadBalance {type: load-balance, interval: 6, lazy: true, url: 'http://www.google.com/blank.html', disable-udp: false, strategy: consistent-hashing, timeout: 2000, max-failed-times: 3, hidden: true, include-all-providers: true}
# é”šç‚¹ - è§„åˆ™å‚æ•° [æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡è®¢é˜…è§„åˆ™ï¼Œæ›´æ–°è§„åˆ™æ—¶ä½¿ç”¨ç›´è¿ç­–ç•¥]
RuleProviders: &RuleProviders {type: http, behavior: classical, interval: 3600, format: yaml, proxy: Auto}

# è¿œç¨‹è§„åˆ™é…ç½®ï¼Œè‡ªåŠ¨æ›´æ–°è§„åˆ™æ–‡ä»¶ï¼ˆä¾‹å¦‚å¹¿å‘Šå±è”½ã€ç‰¹æ®Šåº”ç”¨åˆ†æµç­‰ï¼‰
rule-providers:
  LocationDKS:
    <<: *RuleProviders
    path: './rules/LocationDKS.txt'
    url: 'https://github.com/666OS/rules/raw/release/mihomo/domain/LocationDKS.mrs'

  LAN:
    <<: *RuleProviders
    path: './rules/Lan.yaml'
    url: 'https://rule.kelee.one/Clash/LAN_SPLITTER.yaml'

  Direct:
    <<: *RuleProviders
    path: './rules/Direct.yaml'
    url: 'https://rule.kelee.one/Clash/Direct.yaml'

  Proxy:
    <<: *RuleProviders
    path: './rules/Proxy.yaml'
    url: 'https://rule.kelee.one/Clash/Proxy.yaml'

  ChinaDownloadCDN:
    <<: *RuleProviders
    path: './rules/ChinaDownloadCDN.yaml'
    url: 'https://rule.kelee.one/Clash/ChinaDownloadCDN.yaml'

  InternationalDownloadCDN:
    <<: *RuleProviders
    path: './rules/InternationalDownloadCDN.yaml'
    url: 'https://rule.kelee.one/Clash/InternationalDownloadCDN.yaml'

  AI:
    <<: *RuleProviders
    path: './rules/AI.yaml'
    url: 'https://kelee.one/Tool/Clash/Rule/AI.yaml'

  TikTok:
    <<: *RuleProviders
    path: './rules/TikTok.yaml'
    url: 'https://rule.kelee.one/Clash/TikTok.yaml'

  SpeedtestIntl:
    <<: *RuleProviders
    path: './rules/SpeedtestInternational.yaml'
    url: 'https://rule.kelee.one/Clash/SpeedtestInternational.yaml'

  Steam:
    <<: *RuleProviders
    path: './rules/Steam.yaml'
    url: 'https://rule.kelee.one/Clash/Steam.yaml'

  Microsoft:
    <<: *RuleProviders
    path: './rules/Microsoft.yaml'
    url: 'https://rule.kelee.one/Clash/Microsoft.yaml'

  Google:
    <<: *RuleProviders
    path: './rules/Google.yaml'
    url: 'https://rule.kelee.one/Clash/Google.yaml'

  YouTube:
    <<: *RuleProviders
    path: './rules/YouTube.yaml'
    url: 'https://rule.kelee.one/Clash/YouTube.yaml'

  GitHub:
    <<: *RuleProviders
    path: './rules/GitHub.yaml'
    url: 'https://rule.kelee.one/Clash/GitHub.yaml'

  Telegram:
    <<: *RuleProviders
    path: './rules/Telegram.yaml'
    url: 'https://rule.kelee.one/Clash/Telegram.yaml'

  ESET_China:
    <<: *RuleProviders
    path: './rules/ESET_China.yaml'
    url: 'https://rule.kelee.one/Clash/ESET_China.yaml'

  iCloudChina:
    <<: *RuleProviders
    path: './rules/iCloudChina.yaml'
    url: 'https://rule.kelee.one/Clash/iCloudChina.yaml'

  ApplePushNotificationService:
    <<: *RuleProviders
    path: './rules/ApplePushNotificationService.yaml'
    url: 'https://rule.kelee.one/Clash/ApplePushNotificationService.yaml'

  AppleSoftwareUpdates:
    <<: *RuleProviders
    path: './rules/AppleSoftwareUpdates.yaml'
    url: 'https://rule.kelee.one/Clash/AppleSoftwareUpdates.yaml'

  AppleID:
    <<: *RuleProviders
    path: './rules/AppleID.yaml'
    url: 'https://rule.kelee.one/Clash/AppleAccount.yaml'

  AppStore:
    <<: *RuleProviders
    path: './rules/AppStore.yaml'
    url: 'https://rule.kelee.one/Clash/AppStore.yaml'

  TestFlight:
    <<: *RuleProviders
    path: './rules/TestFlight.yaml'
    url: 'https://rule.kelee.one/Clash/TestFlight.yaml'

# è§„åˆ™é›†ï¼Œè°ƒç”¨ä¸Šé¢çš„rule-providersæˆ–è‡ªå®šä¹‰è§„åˆ™ï¼ŒæŒ‡å‘å¯¹åº”ç­–ç•¥ç»„ï¼Œå®ç°æŒ‰åº”ç”¨åˆ†æµ
rules:
  - RULE-SET, LocationDKS, LocationDKS
  - RULE-SET, LAN, DIRECT
  - RULE-SET, Direct, DIRECT
  - RULE-SET, Proxy, Final
  - RULE-SET, ChinaDownloadCDN, DIRECT
  - RULE-SET, InternationalDownloadCDN, Select
  - RULE-SET, AI, AI
  - RULE-SET, TikTok, TikTok
  - RULE-SET, SpeedtestIntl, Select
  - RULE-SET, Steam, Final
  - RULE-SET, Microsoft, Select
  - RULE-SET, Google, Google
  - RULE-SET, YouTube, YouTube
  - RULE-SET, GitHub, Select
  - RULE-SET, Telegram, Telegram
  - RULE-SET, ESET_China, DIRECT
  - RULE-SET, iCloudChina, Apple
  - RULE-SET, ApplePushNotificationService, Apple
  - RULE-SET, AppleSoftwareUpdates, Apple
  - RULE-SET, AppleID, Apple
  - RULE-SET, AppStore, Apple
  - RULE-SET, TestFlight, Apple
  - GEOIP, CN, DIRECT
  - MATCH, Final
